Quero manter a implementaÃ§Ã£o atual do Debank (EVM) exatamente como estÃ¡, pois jÃ¡ estÃ¡ funcionando corretamente e captura o valor correto de PatrimÃ´nio LÃ­quido.

Para TODAS AS OUTRAS PLATAFORMAS, quero mudar a estratÃ©gia de scraping para o modo oportunista que funcionava antes, abandonando completamente a lÃ³gica semÃ¢ntica e de API.

ğŸ”’ REGRA ABSOLUTA

Debank (EVM):

âŒ NÃƒO alterar nada

âŒ NÃƒO refatorar

âŒ NÃƒO â€œmelhorarâ€

âœ… Manter exatamente a lÃ³gica atual

ğŸ” TODAS AS OUTRAS PLATAFORMAS (Solana / Jupiter, Ready, Aptoscan, Seiscan)

Quero usar EXCLUSIVAMENTE DOM scraping oportunista com Puppeteer, com as seguintes regras:

1ï¸âƒ£ EstratÃ©gia â€œMAIOR VALOR MONETÃRIOâ€

ApÃ³s page.goto(), coletar todos os textos do DOM que contenham valores monetÃ¡rios ($, USD, US$).

Converter todos os valores encontrados para nÃºmero.

Selecionar o MAIOR valor positivo encontrado no DOM.

Esse valor deve ser tratado como o saldo principal do portfÃ³lio.

2ï¸âƒ£ Timing semelhante ao que funcionava antes

Executar a leitura logo apÃ³s o carregamento inicial da pÃ¡gina.

NÃ£o aguardar labels como â€œNet Worthâ€, â€œTotal Portfolioâ€ ou equivalentes.

NÃ£o exigir estabilizaÃ§Ã£o longa do valor.

3ï¸âƒ£ Filtros mÃ­nimos de seguranÃ§a

Ignorar valores negativos.

Ignorar valores muito pequenos (ex: < $10).

Ignorar valores associados explicitamente a â€œPnLâ€, â€œFeesâ€, â€œClaimableâ€, quando detectÃ¡vel no texto adjacente.

4ï¸âƒ£ SaÃ­da garantida (anti-loading infinito)

Assim que um valor vÃ¡lido for encontrado, encerrar imediatamente o scraping da wallet.

Timeout mÃ¡ximo de 20 segundos por wallet.

Nunca deixar a wallet em estado â€œLoadingâ€ indefinidamente.

5ï¸âƒ£ ProibiÃ§Ã£o total de API

âŒ NÃƒO usar fetch, axios, interceptaÃ§Ã£o de rede ou chamadas de API.

âŒ NÃƒO tratar essas plataformas como APIs.

âœ… Apenas navegaÃ§Ã£o real via Puppeteer + leitura do DOM.

ğŸ¯ OBJETIVO FINAL

Recuperar o comportamento funcional que jÃ¡ existia antes.

Priorizar funcionamento prÃ¡tico em vez de perfeiÃ§Ã£o semÃ¢ntica.

Manter Debank estÃ¡vel e confiÃ¡vel.

Evitar regressÃµes e estados de â€œIndisponÃ­velâ€ desnecessÃ¡rios.

ğŸ§  POR QUE ISSO Ã‰ O PEDIDO CERTO

MantÃ©m Debank intocado (onde DOM funciona bem)

Volta ao mÃ©todo que jÃ¡ provou funcionar nos outros sites

Evita Canvas / API / interceptaÃ§Ã£o problemÃ¡tica

Elimina loading infinito

Simplifica drasticamente a lÃ³gica